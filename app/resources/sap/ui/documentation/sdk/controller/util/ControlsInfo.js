/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','sap/ui/documentation/library'],function(q,l){"use strict";var p;var C={loadData:function(){if(!p){p=new Promise(function(r,a){l._loadAllLibInfo("","_getDocuIndex",function(L,d){var D=C._getIndices(L,d,function(){r(D);});});});}return p;},_getIndices:function(L,d,c){var a=["Action","Application","Container","Display","Chart","Mini Chart","Layout","List","Popup","Tile","User Input","Testing","Theming","Tutorial","Routing","Data Binding","Data Visualization","Map"];var b=["namespace","since","category"];var f={namespace:{},since:{},category:{},formFactors:{"Independent":true,"Condensed":true,"Compact":true,"Cozy":true}};var F={"-":"Independent","S":"Condensed","SM":"Condensed, Compact","SL":"Condensed, Cozy","SML":"Condensed, Compact, Cozy","M":"Compact","ML":"Compact, Cozy","L":"Cozy"};var e={};e={};e.entityCount=0;e.entities=[];e.filter={};e.samples={};q.each(d,function(i,D){if(!D.explored){return;}else if(!D.explored.samplesRef){q.sap.log.error("explored: cannot register lib '"+D.library+"'. missing 'explored.samplesRef'");return;}else if(Array.isArray(D.explored.samplesRef)&&D.explored.samplesRef.length!==D.explored.samplesRef.filter(function(I){return I.namespace&&I.ref;}).length){q.sap.log.error("explored: cannot register lib '"+D.library+"'. missing 'explored.samplesRef.namespace' or 'explored.samplesRef.ref' in one or more of the configured namespaces");return;}else if(!Array.isArray(D.explored.samplesRef)&&!D.explored.samplesRef.namespace){q.sap.log.error("explored: cannot register lib '"+D.library+"'. missing 'explored.samplesRef.namespace'");return;}else if(!Array.isArray(D.explored.samplesRef)&&!D.explored.samplesRef.ref){q.sap.log.error("explored: cannot register lib '"+D.library+"'. missing 'explored.samplesRef.ref'");return;}else if(!D.explored.entities){q.sap.log.error("explored: cannot register lib '"+D.library+"'. missing 'explored.entities'");return;}else{q.sap.log.info("explored: now reading lib '"+D.library+"'");}if(Array.isArray(D.explored.samplesRef)){D.explored.samplesRef.forEach(function(I){q.sap.registerModulePath(I.namespace,""+I.ref);});}else{q.sap.registerModulePath(D.explored.samplesRef.namespace,""+D.explored.samplesRef.ref);}q.each(D.explored.samples,function(i,s){if(!s.id){q.sap.log.error("explored: cannot register sample '?'. missing 'id'");}else if(!s.name){q.sap.log.error("explored: cannot register sample '"+s.id+"'. missing 'name'");}else{e.samples[s.id]=s;}});q.each(D.explored.entities,function(j,E){if(!E.id){q.sap.log.error("explored: cannot register entity '?'. missing 'id'");return;}if(D.explored.entitiesDefaults){q.each(D.explored.entitiesDefaults,function(k,v){if(!E.hasOwnProperty(k)){E[k]=v;}});}var I=E.id.lastIndexOf(".");var n=(I!==-1)?E.id.substring(0,I):E.id;E.namespace=n;if(!E.name){q.sap.log.error("explored: cannot register entity '"+E.id+"'. missing 'name'");return;}if(a.indexOf(E.category)===-1){q.sap.log.error("explored: cannot register entity '"+E.id+"'. category '"+E.category+"' is not allowed");return;}if(!E.formFactors){q.sap.log.error("explored: cannot register entity '"+E.id+"'. missing 'formFactors'");return;}if(!F[E.formFactors]){q.sap.log.error("explored: cannot register entity '"+E.id+"'. formFactors '"+E.formFactors+"' is not allowed");return;}E.formFactors=F[E.formFactors];var A=false;q.each(b,function(i,s){if(!E[s]){q.sap.log.error("explored: cannot register entity '"+E.id+"'. missing '"+s+"'");A=true;return false;}});if(A){return;}q.each(b,function(i,s){f[s][E[s]]=true;});E.library=D.library;e.entities.push(E);});});q.each(e.entities,function(n,E){var i=0,s,h;E.searchTags=E.name+" "+E.name.replace(" ","")+" "+E.category;if(E.samples&&!(E.samples instanceof Array)){E.samples=[];q.sap.log.error("explored: cannot register samples for entity '"+E.id+"'. 'samples' is not an array");return;}if(!E.samples){E.samples=[];}if(E.samplesAsSteps){if(!(E.samplesAsSteps instanceof Array)){q.sap.log.error("explored: cannot register samples for entity '"+E.id+"'. 'samplesAsSteps' is not an array");return;}h=function(N){if(N.toString().length===1){return"0"+N;}return N;};for(;i<E.samplesAsSteps.length;i++){s={"id":E.id+"."+h(i+1),"name":E.name+" - Step "+(i+1)+" - "+E.samplesAsSteps[i]};if(i>0){s.previousSampleId=E.id+"."+h(i);}if(i<E.samplesAsSteps.length-1){s.nextSampleId=E.id+"."+h(i+2);}E.samples.push(s);e.samples[s.id]=s;E.searchTags+=" "+s.name;}}else{var S=[],k;q.each(E.samples,function(j,I){var m=e.samples[I];if(!m){q.sap.log.warning("explored: cannot register sample '"+I+"' for '"+E.id+"'. not found in the available docu indizes");}else{m.previousSampleId=(k?k.id:undefined);if(k){k.nextSampleId=m.id;}k=m;S.push(m);E.searchTags+=" "+m.name;}});E.samples=S;}E.sampleCount=E.samples.length;});e.entityCount=e.entities.length;q.each(f,function(s,h){e.filter[s]=[];q.each(h,function(k,v){e.filter[s].push({id:k});});});var o=l._getLibraryInfoSingleton();var g={};var P=[];for(var i=0;i<L.length;i++){P.push(new Promise(function(r){var h=function(j){g[j.library]=j.componentInfo;r();};o._getLibraryInfo(L[i],h);}));}Promise.all(P).then(function(){c&&c();});e.libComponentInfos=g;e.groups=this.getGroups(e.entities);return e;},findGroup:function(g,n){var a;for(var i=0;i<g.length;i++){a=g[i];if(a.name==n){return a;}}},getGroups:function(e){var g=[],a,b,s,c,i,j;for(i=0;i<e.length;i++){a=e[i];a.key='#/entity/'+a.id;s=a.samples;for(j=0;j<s.length;j++){c=s[j];c.key='#/sample/'+c.id+"/preview";}b=this.findGroup(g,a.category);if(!b){b={name:a.category,key:'#/group/'+a.category,controls:[a]};g.push(b);}else{b.controls.push(a);}}return g;}};return C;},true);
